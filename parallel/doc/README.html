<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>
<h1 id="deprecated">** DEPRECATED **</h1>
<h1 id="name">Name</h1>
<p>Parallel Region Analyzer</p>
<h1 id="description">Description</h1>
<p>Processes a BAM file by spawning a process to handle each region in the BAM file. Each process creates a new BAM file for that region, creates a mpileup file, and finally creates a vcf file. The workflow can be pictured like this:</p>
<p><strong>region -&gt; [samtools mpileup] -&gt; [VarScan]</strong></p>
<p>The vcf files are then merged into one file that is located in <code>vcf_*/</code> with the name of the passed in BAM file. The arguments to pass to VarScan are read from a <code>varscan.conf</code> file and the arguments to pass to samtools are read from a <code>samtools.conf</code> file. This file is expected to be in the current working directory.</p>
<h1 id="dependencies-and-preliminaries">Dependencies and Preliminaries</h1>
<h2 id="python-libraries">Python Libraries</h2>
<ul>
<li>pysam: install with <code>pip install pysam</code>.</li>
<li>futures: install with <code>pip install futures</code>.</li>
</ul>
<p><sub> * only if using a Python version &lt; 3 * </sub> * argparse: install with <code>pip install argparse</code>.</p>
<p><sub> * only if using a Python version &lt; 2.7 * </sub> ## Other Software * samtools: install from <a href="http://samtools.sourceforge.net/">SourceForge</a> or with Homebrew if using OS X. * vcftools: install from <a href="http://vcftools.sourceforge.net/">SourceForge</a> or with Homebrew if using OS X. Be sure to export the <code>PERL5LIB</code> variable. * VarScan: install from <a href="http://varscan.sourceforge.net/">SourceForge</a>.</p>
<h1 id="synopsis">Synopsis</h1>
<pre><code>chromo_split infile action varscan_location</code></pre>
<h2 id="arguments">Arguments</h2>
<ul>
<li><code>infile</code>: the path of the BAM file to process.</li>
<li><code>action</code>: the action for VarScan to run.</li>
<li><code>varscan_location</code>: the path to the VarScan jar.</li>
</ul>
<h2 id="options">Options</h2>
<h3 id="options-related-to-the-bam-file">Options Related to the BAM File</h3>
<ul>
<li><p><code>--index</code>: if the BAM file has not been indexed this flag should be passed.</p></li>
<li><p><code>--sort</code>: if the BAM file has not been sorted this flag should be passed. This switch implies <code>--index</code>.</p></li>
</ul>
<h3 id="options-related-to-configuration-files">Options Related to Configuration Files</h3>
<ul>
<li><p><code>--varscan-conf</code>: the location of <code>varscan.conf</code> if one is <em>not</em> in the current working directory.</p></li>
<li><p><code>--samtools-conf</code>: the location of <code>samtools.conf</code> if one is <em>not</em> in the current working directory</p></li>
</ul>
<h3 id="other-options">Other Options</h3>
<ul>
<li><p><code>--with-pipe</code>: instead of writing the intermediate files to disk, the commands are piped into each other, avoiding disk IO. The directories for BAM files and mpileup files are not created. Equivalent to</p>
<pre><code>samtools mpileup test.bam | java -jar Varscan.jar</code></pre></li>
<li><p><code>--n-procs</code>: the total number of concurrent processes to run at a time. The default is two processes.</p></li>
<li><p><code>--keep-bam</code>: keeps the BAM files for each region. The default behavior is to remove the BAM file once the mpileup file has been created.</p></li>
<li><p><code>--keep-mpileup</code>: keeps the mpileup files for each region. The default behavior is to remove them once the vcf file has been created.</p></li>
<li><p><code>--keep-all</code>: keeps the BAM file and the mpileup files. Implies <code>--keep-bam</code> and <code>--keep-mpileup</code>.</p></li>
<li><p><code>-v</code>, <code>--verbose</code>: if this flag is passed, additional information will be printed out while the program is running.</p></li>
</ul>
<h1 id="examples">Examples</h1>
<p>The most basic usage is:</p>
<pre><code>chromo_split your.bam mpileup2snp VarScan.jar</code></pre>
<p>This command will run <code>mpileup2snp</code> on the regions of <code>your.bam</code>, processing two regions in parallel.</p>
<p>There is also a <code>--verbose</code> flag.</p>
<pre><code>chromo_split your.bam mpileup2snp VarScan.jar --verbose</code></pre>
<p>This command will run <code>mpileup2snp</code> on the regions of <code>your.bam</code> and print additional information as each step completes. You can also specify <code>--verbose</code> with <code>-v</code>.</p>
<p>If you would like to keep some of the intermediate files, this example shows how to keep the BAM files created.</p>
<pre><code>chromo_split your.bam mpileup2snp VarScan.jar --keep-bam</code></pre>
<p>This command will run <code>mpileup2snp</code> on the regions of <code>your.bam</code> and will keep the intermediate BAM files that are created in the process.</p>
<p>If you want the program to run a little faster, this example shows how to avoid disk IO.</p>
<pre><code>chromo_split your.bam mpileup2snp VarScan.jar --with-pipe</code></pre>
<p>If you want the number of processes to be limited to one, you can run the program like this:</p>
<pre><code>chromo_split your.bam mpileup2snp VarScan.jar --n-procs=1</code></pre>
<p>Finally, if there isn't a <code>varscan.conf</code> in your working directory, you need to pass the path to a <code>varscan.conf</code></p>
<pre><code>chromo_split your.bam mpileup2snp VarScan.jar --varscan-conf=/home/You/varscan.conf</code></pre>
<h1 id="notes">Notes</h1>
<ul>
<li><p>The program creates three directories in your working directory with the prefixes of <code>bam_</code>, <code>mpileup_</code>, and <code>vcf_</code> the suffix of each will be the name of the passed in file. i.e <code>chromo_split test.bam [...]</code> will create <code>bam_test/</code>, <code>mpileup_test/</code>, and <code>vcf_test/</code>.</p></li>
<li><p>To save space, the default behavior is to delete each file once it has been processed. For small BAM files the three directories shouldn't be a problem, but processing a bigger BAM file can produce a lot of additional data. If you would like to keep the BAM file pass <code>--keep-bam</code>; if you would like to keep the mpileup files pass <code>--keep-mpileup</code>; finally, if you would like to keep all the files pass <code>--keep-all</code>. The vcf files are <em>always</em> kept.</p></li>
<li><p>The <code>varscan.conf</code> and <code>samtools.conf</code> files are simply files where each argument and switch to pass to VarScan or samtools are on a single line. To see examples of these files look <a href="../chromoprocessor/doc/README.html">here</a></p></li>
</ul>
</body>
</html>
